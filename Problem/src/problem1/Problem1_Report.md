# Problem 1: Classical Unit Commitment Model - 求解报告

## 1. 问题概述

### 1.1 问题描述

Problem 1 要求构建并求解经典机组组合（Unit Commitment, UC）优化模型。该问题需要在满足系统约束的前提下，确定各机组在24小时内的开/停状态和出力水平，以最小化总运行成本。

### 1.2 系统参数

- **机组数量**: 6台（Unit 1, 2, 5, 8, 11, 13）
- **时间周期**: 24小时
- **负荷范围**: 131 - 263 MW
- **最小运行时间来源**: Table 2 (Part B)

### 1.3 机组参数

| 机组 | P_max (MW) | P_min (MW) | Min_Up (h) | Min_Down (h) | Ramp_Up (MW/h) | Ramp_Down (MW/h) | 初始状态 |
|------|------------|------------|------------|--------------|----------------|------------------|----------|
| 1    | 300        | 50         | 5          | 3            | 80             | 80               | ON       |
| 2    | 180        | 20         | 4          | 2            | 80             | 80               | ON       |
| 5    | 50         | 15         | 3          | 2            | 50             | 50               | ON       |
| 8    | 35         | 10         | 3          | 2            | 50             | 50               | ON       |
| 11   | 30         | 10         | 1          | 1            | 60             | 60               | ON       |
| 13   | 40         | 12         | 4          | 2            | 60             | 60               | ON       |

**注**: 所有机组初始状态均为开机（ON），初始运行时间满足最小运行时间要求。

---

## 2. 模型构建

### 2.1 目标函数

最小化总运行成本，包括：

1. **燃料成本**（二次成本函数）:
   $$
   \sum_{i} \sum_{t} [a_i \cdot p_{i,t}^2 + b_i \cdot p_{i,t} + c_i]
   $$
   其中：
   - $a_i, b_i, c_i$ 为机组 $i$ 的燃料成本系数
   - $p_{i,t}$ 为机组 $i$ 在时段 $t$ 的出力

2. **启动/停机成本**:
   $$
   \sum_{i} \sum_{t} [StartupCost_i \cdot v_{i,t} + ShutdownCost_i \cdot w_{i,t}]
   $$
   其中：
   - $v_{i,t}$ 为机组 $i$ 在时段 $t$ 的启动指示变量（二进制）
   - $w_{i,t}$ 为机组 $i$ 在时段 $t$ 的停机指示变量（二进制）

### 2.2 约束条件

#### 2.2.1 功率平衡约束
$$
\sum_{i} p_{i,t} = Load_t \quad \forall t
$$
确保每个时段的发电总量等于负荷需求。

#### 2.2.2 发电限制约束
$$
P_{min,i} \cdot u_{i,t} \leq p_{i,t} \leq P_{max,i} \cdot u_{i,t} \quad \forall i, t
$$
其中 $u_{i,t}$ 为机组 $i$ 在时段 $t$ 的投入状态（二进制变量）。

#### 2.2.3 最小运行/停机时间约束

- **最小运行时间**: 机组启动后必须连续运行至少 $MinUpTime_i$ 个时段
- **最小停机时间**: 机组停机后必须连续停机至少 $MinDownTime_i$ 个时段

考虑初始状态：
- 如果机组初始为开机状态，必须满足剩余最小运行时间要求
- 如果机组初始为停机状态，必须满足剩余最小停机时间要求

#### 2.2.4 爬坡率约束

- **爬坡上升约束**:
  $$
  p_{i,t} - p_{i,t-1} \leq RampUp_i \cdot u_{i,t-1} + P_{max,i} \cdot (1 - u_{i,t-1})
  $$

- **爬坡下降约束**:
  $$
  p_{i,t-1} - p_{i,t} \leq RampDown_i \cdot u_{i,t} + P_{max,i} \cdot (1 - u_{i,t})
  $$

#### 2.2.5 启动/停机逻辑约束

- **状态转换关系**:
  $$
  v_{i,t} - w_{i,t} = u_{i,t} - u_{i,t-1} \quad \forall i, t
  $$

- **互斥约束**:
  $$
  v_{i,t} + w_{i,t} \leq 1 \quad \forall i, t
  $$
  确保机组不能同时启动和停机。

### 2.3 求解器配置

- **求解器**: Gurobi Optimizer 10.0.1
- **模型类型**: 混合整数二次规划（MIQP）
- **最优性容差**: 0.01% (MIPGap = 1e-4)
- **变量数量**: 576个（144个连续变量，432个整数变量，其中432个二进制变量）
- **约束数量**: 1176个

---

## 3. 求解结果

### 3.1 最优解

**最优总成本**: **$15,129.08**

**成本分解**:
- 燃料成本: $15,129.08 (100.00%)
- 启动成本: $0.00 (0.00%)
- 停机成本: $0.00 (0.00%)

### 3.2 机组运行状态

**重要发现**: 所有机组在所有24个时段均保持开机状态，没有发生任何启动或停机事件。

这一结果的原因：
- 所有机组初始状态均为开机
- 最小发电量总和 = 50 + 20 + 15 + 10 + 10 + 12 = **117 MW**
- 最小负荷需求 = **131 MW**
- 由于最小发电量（117 MW）小于最小负荷（131 MW），保持所有机组开机是经济合理的选择

### 3.3 发电计划

各机组24小时总发电量及平均出力：

| 机组 | 总发电量 (MWh) | 平均出力 (MW) | 最大出力 (MW) | 最小出力 (MW) | 利用率 (%) |
|------|----------------|---------------|---------------|---------------|------------|
| 1    | 1,272.40       | 53.02         | 62.24         | 50.00         | 100.0      |
| 2    | 1,478.92       | 61.62         | 78.27         | 33.59         | 100.0      |
| 5    | 558.10         | 23.25         | 27.92         | 15.41         | 100.0      |
| 8    | 686.10         | 28.59         | 35.00         | 10.00         | 100.0      |
| 11   | 449.46         | 18.73         | 29.79         | 10.00         | 100.0      |
| 13   | 458.02         | 19.08         | 29.79         | 12.00         | 100.0      |

**关键观察**:
- Unit 1 出力始终接近最小出力（50 MW），功率利用率仅 1.2%
- Unit 2 出力变化范围最大，承担主要调峰任务
- Unit 8 功率利用率最高（74.4%），接近满负荷运行
- 所有机组利用率均为100%（所有时段均开机）

### 3.4 典型时段分析

#### 高峰负荷时段（Period 5）
- **负荷**: 263 MW（最高）
- **发电分配**:
  - Unit 1: 62.24 MW
  - Unit 2: 78.27 MW（接近最大出力）
  - Unit 5: 27.92 MW
  - Unit 8: 35.00 MW（满负荷）
  - Unit 11: 29.79 MW（接近最大出力）
  - Unit 13: 29.79 MW

#### 低谷负荷时段（Period 24）
- **负荷**: 131 MW（最低）
- **发电分配**:
  - Unit 1: 50.00 MW（最小出力）
  - Unit 2: 33.59 MW
  - Unit 5: 15.41 MW（接近最小出力）
  - Unit 8: 10.00 MW（最小出力）
  - Unit 11: 10.00 MW（最小出力）
  - Unit 13: 12.00 MW（最小出力）

---

## 4. 约束验证

### 4.1 功率平衡约束

✅ **验证通过**: 所有24个时段的功率平衡约束均满足，最大误差 < 0.000001 MW

### 4.2 发电限制约束

✅ **验证通过**: 所有机组在所有时段的出力均满足：
- 开机时：$P_{min,i} \leq p_{i,t} \leq P_{max,i}$
- 停机时：$p_{i,t} = 0$

**边界情况检查**:
- Unit 1: 多个时段出力为 50.00 MW（最小出力）
- Unit 8: Period 3-8, 15-22 出力为 35.00 MW（最大出力）
- Unit 11: Period 11, 24 出力为 10.00 MW（最小出力）
- Unit 13: Period 1, 10-12, 23-24 出力为 12.00 MW（最小出力）

### 4.3 最小运行/停机时间约束

✅ **验证通过**: 
- 所有机组初始状态为开机，且满足最小运行时间要求
- 由于没有启动/停机事件，最小运行/停机时间约束自动满足

### 4.4 爬坡率约束

✅ **验证通过**: 所有机组在连续时段之间的出力变化均满足爬坡率限制

**典型爬坡变化**:
- Unit 2: Period 1→2: 52.21 → 58.58 MW（变化 6.37 MW < 80 MW/h）
- Unit 8: Period 2→3: 33.00 → 35.00 MW（变化 2.00 MW < 50 MW/h）
- 所有变化均在爬坡率限制范围内

### 4.5 启动/停机逻辑约束

✅ **验证通过**: 
- 所有时段的启动/停机指示变量均为 0
- 状态转换关系正确：$v_{i,t} - w_{i,t} = u_{i,t} - u_{i,t-1} = 0$
- 互斥约束满足：$v_{i,t} + w_{i,t} = 0 \leq 1$

---

## 5. 结果合理性分析

### 5.1 运行策略合理性

**所有机组保持开机的策略是合理的**，原因如下：

1. **经济性考虑**:
   - 启动成本较高（$40-$180），避免频繁启停可节省成本
   - 燃料成本函数为二次函数，在低出力时成本较低
   - 最小发电量总和（117 MW）小于最小负荷（131 MW），必须保持足够机组在线

2. **技术约束考虑**:
   - 所有机组初始状态为开机，且满足最小运行时间
   - 负荷变化范围（131-263 MW）在系统发电能力范围内
   - 爬坡率约束允许机组在负荷变化时灵活调整出力

### 5.2 成本结构分析

- **燃料成本占比**: 100%
- **启动/停机成本**: 0%
- **成本优化重点**: 通过优化各机组出力分配，最小化二次燃料成本

### 5.3 机组出力分配策略

1. **Unit 1** (P_max=300 MW): 
   - 出力始终接近最小出力（50 MW）
   - 成本系数较高（a=0.02, b=2.00），经济性较差
   - 主要用于满足最小出力要求

2. **Unit 2** (P_max=180 MW):
   - 出力变化范围最大（33.59-78.27 MW）
   - 承担主要调峰任务
   - 成本系数中等（a=0.0175, b=1.75）

3. **Unit 8** (P_max=35 MW):
   - 功率利用率最高（74.4%）
   - 成本系数较低（a=0.00834, b=3.25），经济性较好
   - 在高峰负荷时段满负荷运行

4. **Unit 11, 13** (P_max=30-40 MW):
   - 在高峰时段出力较高，低谷时段接近最小出力
   - 灵活调整以满足负荷变化

---

## 6. 可视化结果

### 6.1 机组组合状态热力图

文件: `1_unit_commitment_heatmap_20251121_212827.png`

- 显示所有机组在24小时内的开/停状态
- 绿色表示开机，红色表示停机
- **观察**: 所有机组在所有时段均为绿色（开机状态）

### 6.2 发电计划曲线图

文件: `2_generation_schedule_20251121_212827.png`

- 显示各机组出力随时间的变化曲线
- 黑色虚线表示负荷需求
- **观察**: 
  - 各机组出力随负荷变化而调整
  - Unit 2 出力变化最明显
  - Unit 1 出力基本稳定在最小出力水平

### 6.3 成本分解图

文件: `3_cost_breakdown_20251121_212827.png`

- 左侧饼图：总成本分解（燃料成本、启动成本、停机成本）
- 右侧柱状图：各机组燃料成本贡献
- **观察**: 
  - 燃料成本占100%
  - Unit 2 燃料成本最高（承担主要发电任务）
  - Unit 1 燃料成本次之（虽然出力较低，但成本系数较高）

### 6.4 堆叠发电面积图

文件: `4_stacked_generation_20251121_212827.png`

- 显示各机组出力的堆叠面积图
- 黑色实线表示负荷需求
- **观察**: 
  - 总发电量（堆叠面积）始终等于负荷需求
  - 各机组出力分配合理，满足功率平衡

### 6.5 机组利用率统计图

文件: `5_unit_utilization_20251121_212827.png`

- 左侧：机组利用率（开机时段占比）
- 右侧：各机组24小时总发电量
- **观察**: 
  - 所有机组利用率均为100%
  - Unit 2 总发电量最高（1,478.92 MWh）
  - Unit 11 总发电量最低（449.46 MWh）

---

## 7. 模型符合性检查

### 7.1 题目要求对比

根据 Problem 1 的要求，模型必须包含以下组件：

#### ✅ 目标函数
1. **燃料成本（二次或分段线性）**: ✅ 已实现二次成本函数
2. **启动/停机成本**: ✅ 已实现启动/停机成本项

#### ✅ 约束条件
1. **功率平衡约束**: ✅ 已实现
2. **发电限制约束**: ✅ 已实现
3. **最小运行/停机时间约束**: ✅ 已实现，并考虑了初始状态
4. **爬坡率约束**: ✅ 已实现，并考虑了初始功率
5. **启动/停机逻辑约束**: ✅ 已实现，包括状态转换关系和互斥约束

### 7.2 实现细节

- **互斥约束** (`v[i,t] + w[i,t] <= 1`): 这是启动/停机逻辑约束的一部分，属于题目要求(5)
- **初始状态处理**: 正确实现了最小运行/停机时间约束和爬坡率约束的初始状态处理
- **无额外约束**: 未发现超出 Problem 1 要求的约束（如网络约束、N-1约束等）

**结论**: Problem 1 的实现完全符合题目要求，没有超出题目约束严格性的问题。

---

## 8. 求解性能

### 8.1 求解时间

- **求解时间**: < 0.02 秒
- **节点数**: 1 个节点
- **单纯形迭代次数**: 1,077 次
- **求解状态**: 最优解（OPTIMAL）

### 8.2 模型规模

- **变量总数**: 576
  - 连续变量: 144（出力变量 $p_{i,t}$）
  - 整数变量: 432（二进制变量）
    - 144个投入状态变量 $u_{i,t}$
    - 144个启动指示变量 $v_{i,t}$
    - 144个停机指示变量 $w_{i,t}$

- **约束总数**: 1,176
  - 功率平衡约束: 24
  - 发电限制约束: 288（144个上界，144个下界）
  - 启动/停机逻辑约束: 144
  - 最小运行时间约束: 144
  - 最小停机时间约束: 144
  - 爬坡率约束: 288（144个上升，144个下降）
  - 互斥约束: 144

### 8.3 求解质量

- **最优性容差**: 0.0001% (1e-4)
- **Gap**: 0.0000%
- **解的状态**: 全局最优解

---

## 9. 结论与建议

### 9.1 主要结论

1. **最优策略**: 所有机组在所有时段保持开机状态，通过调整出力满足负荷需求
2. **最优成本**: $15,129.08，全部为燃料成本
3. **约束满足**: 所有约束条件均满足，解的质量高
4. **模型正确性**: 模型实现完全符合 Problem 1 的要求

### 9.2 结果特点

1. **无启停事件**: 由于所有机组初始状态为开机，且最小发电量小于最小负荷，保持所有机组开机是最优策略
2. **出力分配**: 各机组出力根据成本系数和负荷需求合理分配
3. **边界运行**: 部分机组在部分时段运行在最小或最大出力边界

### 9.3 后续工作建议

1. **敏感性分析**: 可以分析燃料成本系数变化对最优解的影响
2. **负荷变化**: 可以分析不同负荷曲线对机组组合策略的影响
3. **初始状态**: 可以分析不同初始状态对最优解的影响
4. **扩展模型**: 为 Problem 2 做准备，考虑网络约束和N-1安全约束

---

## 10. 文件清单

### 10.1 结果文件

- `uc_schedule_20251121_212827.csv`: 机组组合和发电计划详细数据
- `generation_schedule_20251121_212827.csv`: 发电计划数据
- `summary_20251121_212827.json`: 优化结果摘要（JSON格式）

### 10.2 可视化文件

- `1_unit_commitment_heatmap_20251121_212827.png`: 机组组合状态热力图
- `2_generation_schedule_20251121_212827.png`: 发电计划曲线图
- `3_cost_breakdown_20251121_212827.png`: 成本分解图
- `4_stacked_generation_20251121_212827.png`: 堆叠发电面积图
- `5_unit_utilization_20251121_212827.png`: 机组利用率统计图

### 10.3 代码文件

- `src/problem1/uc_gurobi.py`: 主求解程序
- `src/problem1/verify.py`: 结果验证程序
- `src/problem1/check_constraints_compliance.py`: 约束符合性检查程序
- `src/problem1/check_period12.py`: 特定时段检查程序
- `src/problem1/detailed_check.py`: 详细检查程序

---

## 附录

### A. 燃料成本系数

| 机组 | a (二次项系数) | b (一次项系数) | c (常数项) |
|------|----------------|----------------|------------|
| 1    | 0.0200         | 2.00           | 0          |
| 2    | 0.0175         | 1.75           | 0          |
| 5    | 0.0625         | 1.00           | 0          |
| 8    | 0.00834        | 3.25           | 0          |
| 11   | 0.0250         | 3.00           | 0          |
| 13   | 0.0250         | 3.00           | 0          |

### B. 启动/停机成本

| 机组 | 启动成本 ($) | 停机成本 ($) |
|------|--------------|--------------|
| 1    | 180          | 180          |
| 2    | 180          | 180          |
| 5    | 40           | 40           |
| 8    | 60           | 60           |
| 11   | 60           | 60           |
| 13   | 40           | 40           |

### C. 24小时负荷需求

| 时段 | 负荷 (MW) | 时段 | 负荷 (MW) | 时段 | 负荷 (MW) | 时段 | 负荷 (MW) |
|------|-----------|------|-----------|------|-----------|------|-----------|
| 1    | 166       | 7    | 246       | 13   | 170       | 19   | 236       |
| 2    | 196       | 8    | 213       | 14   | 185       | 20   | 225       |
| 3    | 229       | 9    | 192       | 15   | 208       | 21   | 204       |
| 4    | 257       | 10   | 161       | 16   | 232       | 22   | 182       |
| 5    | 263       | 11   | 147       | 17   | 246       | 23   | 161       |
| 6    | 252       | 12   | 160       | 18   | 241       | 24   | 131       |

---

**报告生成时间**: 2025年11月21日  
**求解器版本**: Gurobi Optimizer 10.0.1  
**最小运行时间来源**: Table 2 (Part B)

